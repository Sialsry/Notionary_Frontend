# Notionary 질의응답 커뮤니티 사이트 회고록

https://react01.shop/

## 목차

| 번호                            | 항목 이름               |
| ------------------------------- | ----------------------- |
| [1](#1-역할-및-담당-기능)       | 역할 및 담당 기능       |
| [2](#2-api-문서)                | api 문서                |
| [3](#3-구현한-기능-상세)        | 구현한 기능 상세        |
| [4](#4-기술적으로-새로-배운-점) | 기술적으로 새로 배운 점 |
| [5](#5-어려웠던-점과-해결-과정) | 어려웠던 점과 해결 과정 |
| [6](#6-협업-과정에서-느낀-점)   | 협업 과정에서 느낀 점   |
| [7](#7-전체-회고-및-느낀-점)    | 전체 회고 및 느낀 점    |

---

## 1. 역할 및 담당 기능

페이지 별 역할 분담: 로그인/회원가입 페이지, 마이페이지, 게시글 상세페이지

### 🔐 로그인/회원가입 페이지

- **회원가입 기능**: 아이디 중복 확인 및 신규 계정 생성
- **로그인 인증**: JWT 토큰 기반 사용자 인증 시스템
- **토큰 검증**: 로그인 상태 유지 및 인증 미들웨어 구현
- **입력 유효성 검사**: 클라이언트/서버 양방향 데이터 검증

### 👤 마이페이지

- **내 게시글 조회**: 사용자가 작성한 게시글 목록 관리
- **좋아요한 게시글**: 사용자 관심 게시글 추적 및 조회
- **댓글 단 게시글**: 사용자 활동 내역 및 참여도 관리

### 📝 게시글 상세페이지

- **게시글 상세 조회**: 게시글 내용, 작성자 정보, 메타데이터 표시
- **좋아요 토글**: 실시간 좋아요 기능 및 상태 관리
- **댓글 시스템**: 댓글 CRUD 기능 (생성, 수정, 삭제)
- **권한 관리**: 작성자별 수정/삭제 권한 제어 및 보안 처리

---

## 2. API 문서

### 인증 관련

| Method | URL                  | 설명                         |
| ------ | -------------------- | ---------------------------- |
| `POST` | `/api/auth/check-id` | 회원가입 시 아이디 중복 확인 |
| `POST` | `/api/auth/register` | 새 계정 회원가입             |
| `POST` | `/api/auth/login`    | 로그인 처리 후 JWT 토큰 발급 |
| `GET`  | `/api/auth/verify`   | JWT 토큰 유효성 검증         |

---

### 유저 관련

| Method | URL            | 설명                            |
| ------ | -------------- | ------------------------------- |
| `GET`  | `/user/info`   | 로그인된 유저 정보 조회         |
| `POST` | `/user/update` | 유저 정보 및 프로필 이미지 수정 |

---

### 메인 페이지 관련

| Method   | URL                      | 설명                      |
| -------- | ------------------------ | ------------------------- |
| `GET`    | `/main/`                 | 전체 게시글 조회          |
| `POST`   | `/main/subpost`          | 카테고리별 게시글 조회    |
| `GET`    | `/main/etc`              | 기타 카테고리 게시글 조회 |
| `GET`    | `/main/category`         | 전체 카테고리 조회        |
| `POST`   | `/main/comment`          | 댓글 생성                 |
| `GET`    | `/main/comment/:post_id` | 특정 게시글의 댓글 조회   |
| `POST`   | `/main/heart`            | 게시글 좋아요 추가        |
| `DELETE` | `/main/heartDelete`      | 게시글 좋아요 취소        |

---

### 게시글 관련

| Method | URL                   | 설명                                       |
| ------ | --------------------- | ------------------------------------------ |
| `POST` | `/post/`              | 새 게시글 작성 (이미지/동영상 업로드 포함) |
| `POST` | `/post/getWorkspace`  | 유저의 워크스페이스 목록 조회              |
| `PUT`  | `/post/edit/:post_id` | 게시글 수정                                |
| `GET`  | `/post/:post_id`      | 특정 게시글 조회                           |

---

### 게시글 상세 관련

| Method   | URL                            | 설명                  |
| -------- | ------------------------------ | --------------------- |
| `GET`    | `/detail/:post_id`             | 게시글 상세 정보 조회 |
| `POST`   | `/detail/:post_id/like`        | 게시글 좋아요 토글    |
| `POST`   | `/detail/:post_id/comments`    | 댓글 생성             |
| `PUT`    | `/detail/comments/:comment_id` | 댓글 수정             |
| `DELETE` | `/detail/comments/:comment_id` | 댓글 삭제             |
| `DELETE` | `/detail/:post_id`             | 게시글 삭제           |

---

### 마이페이지 관련

| Method | URL                         | 설명                      |
| ------ | --------------------------- | ------------------------- |
| `GET`  | `/mypage/getMyPost`         | 내가 작성한 게시글 조회   |
| `GET`  | `/mypage/getLikedPosts`     | 내가 좋아요한 게시글 조회 |
| `GET`  | `/mypage/getCommentedPosts` | 내가 댓글단 게시글 조회   |
| `GET`  | `/mypage/getMyWorkspace`    | 내 워크스페이스 조회      |

---

### 워크스페이스 관련

| Method | URL                                                                      | 설명                          |
| ------ | ------------------------------------------------------------------------ | ----------------------------- |
| `POST` | `/workspace/newFolder`                                                   | 새 폴더 생성                  |
| `POST` | `/workspace/newPage`                                                     | 새 페이지 생성                |
| `GET`  | `/workspace/selectspace/:workspacename/:foldername/:filename`            | 특정 워크스페이스 페이지 조회 |
| `POST` | `/workspace/selectspace/:workspacename/:foldername/:filename`            | 워크스페이스 페이지 내용 저장 |
| `POST` | `/workspace/selectspace/:workspacename/:foldername/:_filename/image/:id` | 워크스페이스 이미지 업로드    |
| `GET`  | `/workspace/workspacedataOne`                                            | 개인 워크스페이스 데이터 조회 |
| `POST` | `/workspace/delworkspace`                                                | 워크스페이스 폴더 삭제        |
| `POST` | `/workspace/delworkspacepage`                                            | 워크스페이스 페이지 삭제      |
| `POST` | `/workspace/getBlockIdcontent`                                           | 특정 블록 ID 콘텐츠 조회      |

---

## 3. 구현한 기능 상세

### 1. 로그인/회원가입 시스템

![streaming start](./public/images/readmegif/1.gif)

- **JWT 기반 인증**: 토큰 발급 및 검증을 통한 보안성 높은 사용자 인증 구현

- **아이디 중복 확인**: 회원가입 시 실시간 아이디 중복 검사로 사용자 편의성 향상

- **인증 미들웨어**: 보호된 라우트에 대한 접근 제어 및 사용자 정보 자동 추출

---

### 2. 마이페이지 활동 내역 관리

![streaming start](./public/images/readmegif/2.gif)

- **내 게시글 조회**: 사용자가 작성한 게시글을 시간순으로 정렬하여 표시

- **좋아요한 게시글**: 관심 있는 게시글을 별도로 관리하고 쉽게 재접근 가능

- **댓글 활동 추적**: 댓글을 남긴 게시글들을 한눈에 확인하여 참여도 시각화

- **워크스페이스 연동**: 개인/팀 워크스페이스와 게시글 간의 연결 관계 표시

---

### 3. 게시글 상세페이지 인터랙션

![streaming start](./public/images/readmegif/3.gif)

- **실시간 좋아요**: 새로고침 없이 좋아요 상태 토글 및 즉시 반영

- **댓글 시스템**: 댓글 작성, 수정, 삭제 기능과 실시간 업데이트

- **권한 기반 제어**: 작성자만 수정/삭제 가능하도록 하는 보안 처리

- **상세 정보 표시**: 게시글 메타데이터, 작성자 정보, 관련 워크스페이스 정보 통합 제공

---

## 4. 기술적으로 새로 배운 점

### JWT 기반 인증 시스템 구축

- **토큰 생성 및 검증**: `jsonwebtoken` 라이브러리를 활용한 JWT 토큰 발급 및 유효성 검사
- **미들웨어 패턴**: Express 미들웨어를 통한 인증 로직 분리 및 재사용성 향상
- **쿠키 기반 토큰 관리**: `cookie-parser`를 활용한 안전한 토큰 저장 및 자동 전송

### Sequelize ORM과 데이터베이스 설계

- **관계형 데이터 모델링**: 사용자, 게시글, 댓글, 좋아요 간의 복잡한 관계 설정
- **조인 쿼리 최적화**: `include` 옵션을 활용한 효율적인 연관 데이터 조회
- **트랜잭션 처리**: 데이터 일관성 보장을 위한 원자적 연산 구현

### RESTful API 설계 원칙

- **HTTP 메서드 활용**: GET, POST, PUT, DELETE의 적절한 사용법 체득
- **라우터 모듈화**: 기능별로 라우터를 분리하여 코드 구조 개선
- **에러 핸들링**: 일관된 에러 응답 형식 및 상태 코드 관리

### 파일 업로드 처리 및 정적 파일 서비스

- **Multer 미들웨어**: `multipart/form-data` 처리 및 파일 저장 로직
- **정적 파일 서빙**: Express의 `static` 미들웨어를 통한 이미지/동영상 제공
- **파일 경로 관리**: 상대/절대 경로 변환 및 URL 매핑 처리

---

## 5. 어려웠던 점과 해결 과정

### JWT 토큰 검증 미들웨어 구현

**문제**: 인증이 필요한 라우트와 선택적인 라우트 간의 미들웨어 적용 차이로 인한 에러 발생

**해결 과정**:

- 필수 인증과 선택적 인증을 구분하는 미들웨어 함수 분리
- `try-catch`를 통한 토큰 검증 실패 시 적절한 fallback 처리
- 환경변수 `JWT_SECRET_KEY` 존재 여부 사전 검증 로직 추가

### 복합 데이터 조회 쿼리 최적화

**문제**: 게시글, 댓글, 좋아요, 사용자 정보를 한 번에 조회할 때 N+1 쿼리 문제 발생

**해결 과정**:

- Sequelize의 `include` 옵션을 활용한 JOIN 쿼리로 변경
- 필요한 필드만 선택하는 `attributes` 옵션으로 데이터 전송량 최소화
- 조회 성능 모니터링을 통한 쿼리 효율성 검증

### 파일 업로드와 데이터 동시 처리

**문제**: 게시글 작성 시 텍스트 데이터와 이미지/동영상 파일을 함께 처리하는 복잡성

**해결 과정**:

- `multer` 설정을 통한 파일 타입별 분리 저장
- 업로드된 파일 경로를 DB에 저장하고 정적 파일로 서빙하는 구조 설계
- 파일 업로드 실패 시 롤백 처리 및 에러 메시지 제공

### 권한 기반 접근 제어

**문제**: 게시글/댓글 수정/삭제 시 작성자 본인만 접근 가능하도록 하는 권한 검증

**해결 과정**:

- JWT에서 추출한 사용자 ID와 게시글/댓글 작성자 ID 비교 로직 구현
- 미들웨어 단계에서 권한 검증 후 컨트롤러로 전달하는 구조 설계
- 권한 없는 접근 시도에 대한 명확한 에러 응답 정의

### 환경별 설정 관리

**문제**: 개발/배포 환경에서 서로 다른 도메인, 포트, 파일 경로로 인한 설정 충돌

**해결 과정**:

- `.env` 파일을 통한 환경변수 중앙 관리
- CORS 설정에서 환경별 허용 도메인 분리
- 정적 파일 경로를 환경변수로 관리하여 배포 시 자동 적용

---

## 6. 협업 과정에서 느낀 점

- 팀원들과 함께 데이터베이스 구조를 설계할 때, 각자의 담당 기능에서 필요한 데이터 관계를 충분히 논의하지 않아 나중에 테이블 구조를 변경해야 하는 경우가 있었습니다. 이를 통해 초기 설계 단계에서의 소통이 얼마나 중요한지 체감했습니다.

- 각자 담당한 기능들이 서로 연결되어 있어, 한 명의 작업이 지연되면 다른 팀원의 작업에도 영향을 미치는 상황을 경험했습니다. 이를 통해 일정 관리와 의존성을 고려한 작업 순서의 중요성을 깨달았습니다.

---

## 7. 전체 회고 및 느낀 점

- 질의응답 커뮤니티라는 특성상 사용자, 게시글, 댓글, 좋아요 등 복잡한 관계를 가진 데이터들을 다루면서 데이터베이스 설계와 쿼리 최적화의 중요성을 깊이 깨달았습니다. 특히 Sequelize ORM을 통해 관계형 데이터를 객체 지향적으로 다루는 방법을 익혔고, 효율적인 데이터 조회를 위한 JOIN 쿼리의 필요성을 체감했습니다.

- JWT를 활용한 인증 시스템을 구축하면서 웹 애플리케이션 보안의 중요성을 실감했습니다. 단순히 로그인 기능을 만드는 것이 아니라, 토큰 관리, 권한 검증, 환경변수 보안 등 고려해야 할 요소들이 많다는 것을 배웠습니다.

- 혼자서는 경험할 수 없는 실제 협업 개발의 복잡성과 그 안에서의 소통의 중요성을 깊이 이해하게 되었습니다. 코드 리뷰, 브랜치 관리, API 문서화 등 협업을 위한 도구와 프로세스의 필요성을 몸소 체험했고, 이는 실무에서도 매우 중요한 경험이 될 것이라고 생각합니다.
